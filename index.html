<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<title>ピーキング戦略完全版</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
    .container { background: #fff; padding: 20px; border-radius: 10px; max-width: 900px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; }
    button { margin-top: 20px; padding: 10px; font-size: 1em; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th[title] { cursor: help; }
    th { background-color: #eee; }
    @media print {
      body { -webkit-print-color-adjust: exact; }
      table { page-break-inside: avoid; }
    }
    #adjustSummary { margin-top: 20px; padding: 10px; background: #e7f3fe; border-left: 5px solid #2196F3; }
    #output { margin-top: 20px; }
    button:hover { background: #45a049; }
    h2 { color: #333; margin-top: 40px; }
    @media (max-width: 600px) {
      input, select, button { font-size: 1em; }
      h1 { font-size: 1.5em; }
    }
    .input-error {
      border: 2px solid red !important;
    }
</style>
</head>
<body>
<div class="container">
<h1>ピーキング戦略完全版</h1>
<button onclick="window.print()">PDFとして保存 / 印刷</button>

<label>体重（kg）</label>
<input id="weight" placeholder="例：70" type="number" min="30" max="200"/>

<label>TDEE（1日の消費カロリー）※未入力でも可</label>
<input id="tdee" oninput="updatePFCfromTDEE()" placeholder="例：2500" type="number"/>

<label>体脂肪率（％）</label>
<input id="bodyfat" placeholder="例：15" type="number"/>

<label>ピーキング期間</label>
<select id="days">
  <option value="0">ピーキングなし</option>
  <option value="3">3日間</option>
  <option value="5">5日間</option>
  <option selected value="7">7日間</option>
  <option value="10">10日間</option>
</select>

<h2>1日のPFC目標（g）</h2>
<label>タンパク質（P）</label>
<label>食事回数（回）</label>
<select id="mealCount">
  <option value="3">3回</option>
  <option value="4">4回</option>
  <option selected value="5">5回（推奨）</option>
  <option value="6">6回</option>
</select>
<input id="protein" placeholder="例：150" type="number"/>
<label>脂質（F）</label>
<input id="fat" placeholder="例：50" type="number"/>
<label>炭水化物（C）</label>
<input id="carb" placeholder="例：250" type="number"/>

<!-- ボタンはここだけ -->
<button onclick="generateMealPlan()">戦略を表示</button>
<div id="mealPlanError" style="color: red; margin-top: 10px;"></div>

<div id="mealPlanOutput">
  <h2>当日の食事タイミングと内容</h2>
  <table id="mealPlanTable">
    <thead>
      <tr><th>時間</th><th>内容</th><th>P</th><th>F</th><th>C</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div id="adjustSummary"></div>
<div id="output"></div>
<div id="timelineOutput"></div>

<div id="timeScheduleSection">
<h2>大会当日のタイムスケジュール</h2>
<label>起床時間</label><input id="wakeTime" type="time"/>
<label>ステージ開始時間（大会本番）</label><input id="stageTime" type="time"/>
<label>パンプアップ開始時間（ステージ約60分前）</label><input id="pumpTime" type="time"/>
</div>
</div>

<script>
// updatePFCfromTDEE 関数はそのまま
// generateMealPlan 関数も修正済みのものを使ってOK
// 省略可否に応じて、必要なら補足コードを追記します
</script>
</body>
</html>